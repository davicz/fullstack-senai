<div class="flex h-screen bg-gray-100 overflow-hidden">

  <div *ngIf="isMobileMenuOpen" (click)="closeMobileMenu()"
    class="fixed inset-0 z-20 transition-opacity lg:hidden">
  </div>

  <aside
    class="fixed inset-y-0 left-0 z-30 w-64 flex-col bg-white p-4 shadow-lg transform transition-transform duration-300 lg:translate-x-0 lg:static lg:inset-0"
    [class.translate-x-0]="isMobileMenuOpen"
    [class.-translate-x-full]="!isMobileMenuOpen">

    <div class="mb-6 flex flex-col items-center relative">
      <button (click)="closeMobileMenu()" class="absolute right-0 top-0 lg:hidden text-gray-500 hover:text-red-500">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>

      <a [routerLink]="['/app/']" (click)="closeMobileMenu()">
        <img src="../../../assets/logo-tech.png" alt="Logo do Sistema" class="h-12 w-auto object-contain mb-2" />
      </a>
      <h1 class="text-sm font-semibold text-gray-700"></h1>
    </div>

    <nav class="flex flex-col space-y-2 overflow-y-auto">
      <a [routerLink]="['/app/dashboard']" routerLinkActive="bg-blue-100 text-blue-700" (click)="closeMobileMenu()"
        class="rounded-lg px-4 py-3 font-medium text-gray-700 hover:bg-blue-100 hover:text-blue-700 transition-colors">
        Painel
      </a>

      @if (isAdmin()) {
      <a [routerLink]="['/app/reports']" routerLinkActive="bg-blue-100 text-blue-700" (click)="closeMobileMenu()"
        class="rounded-lg px-4 py-3 font-medium text-gray-700 hover:bg-blue-100 hover:text-blue-700 transition-colors">
        Relatórios
      </a>
      }

      @if (isAdmin()) {
      <a [routerLink]="['/app/usuarios']" routerLinkActive="bg-blue-100 text-blue-700" (click)="closeMobileMenu()"
        class="rounded-lg px-4 py-3 font-medium text-gray-700 hover:bg-blue-100 hover:text-blue-700 transition-colors">
        Usuários
      </a>
      }

      @if (isAdmin()) {
      <a [routerLink]="['/app/convites']" routerLinkActive="bg-blue-100 text-blue-700" (click)="closeMobileMenu()"
        class="rounded-lg px-4 py-3 font-medium text-gray-700 hover:bg-blue-100 hover:text-blue-700 transition-colors">
        Convites
      </a>
      }

      @if (isAdmin()) {
      <a [routerLink]="['/app/escolas']" routerLinkActive="bg-blue-100 text-blue-700" (click)="closeMobileMenu()"
        class="rounded-lg px-4 py-3 font-medium text-gray-700 hover:bg-blue-100 hover:text-blue-700 transition-colors">
        Escolas
      </a>
      }

      @if (isAdmin()) {
      <a [routerLink]="['/app/turmas']" routerLinkActive="bg-blue-100 text-blue-700" (click)="closeMobileMenu()"
        class="rounded-lg px-4 py-3 font-medium text-gray-700 hover:bg-blue-100 hover:text-blue-700 transition-colors">
        Turmas
      </a>
      }
    </nav>
  </aside>

  <div class="flex flex-1 flex-col w-full">

    <header class="flex h-16 items-center justify-between bg-white px-4 sm:px-6 shadow-sm z-10">
      <div class="flex items-center gap-4">
        <button (click)="toggleMobileMenu()" class="text-gray-500 hover:text-gray-700 focus:outline-none lg:hidden">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
          </svg>
        </button>

        </div>

      <div class="flex items-center space-x-2 sm:space-x-4">
        <div class="flex items-center space-x-2">
          <span class="hidden sm:inline-flex py-1 px-3 sm:py-2 sm:px-4 bg-green-200 rounded-full text-green-900 text-xs sm:text-base font-bold truncate">
            {{ user?.name }}
          </span>
          <span class="sm:hidden inline-flex justify-center items-center w-8 h-8 bg-green-200 rounded-full text-green-900 font-bold">
            {{ user?.name?.charAt(0) }}
          </span>

          @if (userHasMultipleProfiles) {
          <button (click)="changeProfile()" title="Trocar Perfil"
            class="rounded-full p-1 text-gray-500 hover:bg-blue-100 hover:text-blue-700 transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
              stroke="currentColor" class="h-6 w-6">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M7.5 21 3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5" />
            </svg>
          </button>
          }

          <button (click)="logout()" title="Sair (Logout)"
            class="rounded-full p-1 text-gray-500 hover:bg-red-100 hover:text-red-600 transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
              stroke="currentColor" class="h-6 w-6">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9" />
            </svg>
          </button>
        </div>
      </div>
    </header>

    <main class="flex-1 overflow-y-auto p-4 sm:p-8 bg-gray-100 relative">
      <router-outlet></router-outlet>
    </main>

  </div>
</div>